<!DOCTYPE html>
<html>
<head>
  <title>Verificación de correo electrónico con Firebase</title>
  <!-- Agrega la CDN de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase-auth.js"></script>


</head>

<body>
  <h1>Verificación de correo electrónico con Firebase</h1>
  <form id="register-form">
    <label for="email">Correo electrónico:</label>
    <input type="email" id="email" name="email" required>
    <br>
    <label for="password">Contraseña:</label>
    <input type="password" id="password" name="password" required>
    <br>
    <button type="submit">Registrarse</button>
  </form>
  <script>

        // Agrega la configuración de Firebase
        var firebaseConfig = {
        apiKey: "AIzaSyCG-8m86VO_aB9kJPkI4xIaa8SMGCYHTCg",
  authDomain: "dbsensors.firebaseapp.com",
  databaseURL: "https://dbsensors-default-rtdb.firebaseio.com",
  projectId: "dbsensors",
  storageBucket: "dbsensors.appspot.com",
  messagingSenderId: "1013519019759",
  appId: "1:1013519019759:web:75e854d8032128304e751a",
  measurementId: "G-YD2HFMLCKP"
    };
    // Inicializa Firebase
    firebase.initializeApp(firebaseConfig);
    var registerForm = document.querySelector("#register-form");
    registerForm.addEventListener("submit", function (event) {
      event.preventDefault();
      var email = document.querySelector("#email").value;
      var password = document.querySelector("#password").value;
      // Registra el usuario en Firebase
      firebase.auth().createUserWithEmailAndPassword(email, password)
        .then(function (userCredential) {
          // Envía un correo electrónico de verificación al usuario registrado
          userCredential.user.sendEmailVerification()
            .then(function () {
              alert("Se ha enviado un correo electrónico de verificación. Por favor, verifica tu correo electrónico antes de iniciar sesión.");
              // Agrega un evento de escucha para la verificación de correo electrónico del usuario
              firebase.auth().onAuthStateChanged(function (user) {
                if (user && user.emailVerified) {
                  console.log("Redireccionando a la página de perfil...");
                  alert("Registro completado.");
                  window.location.replace("perfil.html");
                }
              });
            })
            .catch(function (error) {
              console.error(error);
            });
        })
        .catch(function (error) {
          console.error(error);
        });
    });
  </script>
</body>
</html>